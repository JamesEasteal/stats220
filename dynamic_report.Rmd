---
title: Observing Cars on Auckland Roads
output: html_fragment
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo=FALSE, message=FALSE, warning=FALSE, error=FALSE)

```

```{css}
  body {background-color: #e6d6f5 /* Adding a light purple background */}

  h1 {color: #002366 /* Making level 1 headings dark blue */}

  p {font-weight: bold /* Making paragraph text bold */}
  
  h2 {text-decoration: underline /* Adding underline to level 2 headings */}
  
  h3 {color: #6A0DAD /* Making level 3 headings purple*/}
  
  


```

# Real-World Car Observations - STATS 220



```{r}
library(tidyverse)

# Reading CSV from the published Google Sheet
logged_data <- read_csv("https://docs.google.com/spreadsheets/d/e/2PACX-1vTVwRtAOG8keLSMW3iNPuMljHhzUxdneaVlssujx8CEW164W9n2Fu-Uk0taBP0orTpqFkzNpgWjK5Jz/pub?output=csv")

# Renaming data
latest_data <- logged_data %>%
  rename(
    timestamp = 1,
    colour = 2,
    speed_kmh = 3,
    brand = 4,
    loudness = 5,
    group_status = 6
  )
```

```{r}
#Creating numeric summaries
mean_speed <- mean(latest_data$speed_kmh)
max_speed <- max(latest_data$speed_kmh)
min_speed <- min(latest_data$speed_kmh)
num_entries <- nrow(latest_data)
common_colour <- latest_data %>%
  count(colour) %>%
  slice_max(n, n = 1) %>%
  pull(colour)
```

## Dynamic Comments
Based on the `r num_entries` observations, the minimum speed was `r (min_speed)`km/h, the maximum speed was `r (max_speed)`km/h, and the average speed was `r round(mean_speed, 2)` km/h. And the most common colour of car was `r common_colour`.

 


## Bar Graphs
### Number of Each Colour Car Observed
```{r}
# Creating Bar graph 1: Count of colours
ggplot(latest_data) +
  geom_bar(aes(x = colour), fill = "steelblue") +
  labs(
    title = "Car Colour Distribution",
    subtitle = "Based on 20 observed cars in Auckland suburbs",
    x = "Car Colour",
    y = "Number of Cars"
  )
```

### Loudness of Different Car Brands
```{r}
# Creating Bar graph 4: Average loudness by brand
latest_data %>%
  group_by(brand) %>%
  summarise(avg_loudness = mean(loudness)) %>%
  ggplot(aes(x = brand, y = avg_loudness)) +
  geom_col(fill = "purple") +
  labs(
    title = "Average Loudness Rating by Car Brand",
    subtitle = "Loudness rated on a scale from 1 (silent) to 5 (very loud)",
    x = "Car Brand",
    y = "Average Loudness"
  ) +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) #adjusting angle of text
```

### Average Speed Of Different Coloured Cars
```{r}
# Creating Bar graph 3: Average speed by colour
latest_data %>%
  group_by(colour) %>%
  summarise(avg_speed = mean(speed_kmh, na.rm = TRUE)) %>%
  ggplot(aes(x = colour, y = avg_speed)) +
  geom_col(fill = "orange") +
  scale_y_continuous(limits = c(40, 60), oob = scales::squish) +
  labs(
    title = "Average Estimated Speed by Car Colour",
    subtitle = "Do different car colours tend to be driven faster?",
    x = "Car Colour",
    y = "Average Speed (km/h)"
  )
```
  
